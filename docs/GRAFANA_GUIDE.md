# ğŸ“Š Grafana å®æ—¶è¡Œæƒ…æŸ¥çœ‹æŒ‡å—

## ğŸŒ è®¿é—® Grafana

**URL**: http://localhost:3000  
**è´¦å·**: `admin`  
**å¯†ç **: `admin123`

æµè§ˆå™¨åº”è¯¥å·²ç»è‡ªåŠ¨æ‰“å¼€ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¯·æ‰‹åŠ¨è®¿é—®ä¸Šè¿° URLã€‚

---

## ğŸ” ç™»å½•æ­¥éª¤

1. åœ¨ç™»å½•é¡µé¢è¾“å…¥ï¼š
   - **Username**: `admin`
   - **Password**: `admin123`

2. ç‚¹å‡» **Log in**

3. é¦–æ¬¡ç™»å½•å¯èƒ½ä¼šæç¤ºä¿®æ”¹å¯†ç ï¼Œå¯ä»¥ï¼š
   - **Skip** è·³è¿‡
   - æˆ–è®¾ç½®æ–°å¯†ç 

---

## ğŸ“ˆ æŸ¥çœ‹ OKX å®æ—¶æ•°æ®

### æ–¹æ³• 1: ä½¿ç”¨ Exploreï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. ç‚¹å‡»å·¦ä¾§èœå• **â˜°** â†’ **Explore** (æ¢ç´¢å›¾æ ‡)

2. åœ¨é¡¶éƒ¨é€‰æ‹©æ•°æ®æºï¼š**Prometheus**

3. åœ¨æŸ¥è¯¢æ¡†ä¸­è¾“å…¥ä»¥ä¸‹æŒ‡æ ‡ï¼š

#### æŸ¥çœ‹ WebSocket è¿æ¥çŠ¶æ€
```promql
websocket_connected
```
- è¿”å› `1` = å·²è¿æ¥ âœ…
- è¿”å› `0` = æœªè¿æ¥ âŒ

#### æŸ¥çœ‹æ¥æ”¶æ¶ˆæ¯æ•°
```promql
rate(websocket_messages_received_total[1m])
```
- æ˜¾ç¤ºæ¯ç§’æ¥æ”¶çš„æ¶ˆæ¯æ•°

#### æŸ¥çœ‹è¡Œæƒ…æ•°æ®è®¡æ•°
```promql
market_data_tick_count
```
- æŒ‰äº¤æ˜“å¯¹åˆ†ç»„æ˜¾ç¤ºæ¥æ”¶çš„ tick æ•°æ®

4. ç‚¹å‡» **Run query** æŸ¥çœ‹ç»“æœ

5. åœ¨å³ä¸Šè§’å¯ä»¥åˆ‡æ¢è§†å›¾ï¼š
   - **Table** (è¡¨æ ¼)
   - **Graph** (å›¾è¡¨)
   - **Time series** (æ—¶é—´åºåˆ—)

---

### æ–¹æ³• 2: åˆ›å»ºè‡ªå®šä¹‰ä»ªè¡¨æ¿

#### æ­¥éª¤ 1: åˆ›å»ºæ–°ä»ªè¡¨æ¿

1. ç‚¹å‡»å·¦ä¾§ **â˜°** â†’ **Dashboards** â†’ **New** â†’ **New Dashboard**

2. ç‚¹å‡» **Add visualization**

3. é€‰æ‹©æ•°æ®æºï¼š**Prometheus**

#### æ­¥éª¤ 2: æ·»åŠ  WebSocket çŠ¶æ€é¢æ¿

1. åœ¨ **Query** ä¸­è¾“å…¥ï¼š
   ```promql
   websocket_connected
   ```

2. åœ¨å³ä¾§ **Panel options**:
   - **Title**: `WebSocket è¿æ¥çŠ¶æ€`
   - **Panel type**: `Stat` (çŠ¶æ€å€¼)

3. ç‚¹å‡»å³ä¸Šè§’ **Apply**

#### æ­¥éª¤ 3: æ·»åŠ æ¶ˆæ¯é€Ÿç‡é¢æ¿

1. ç‚¹å‡» **Add** â†’ **Visualization**

2. Query:
   ```promql
   rate(websocket_messages_received_total[1m])
   ```

3. Panel options:
   - **Title**: `æ¶ˆæ¯æ¥æ”¶é€Ÿç‡ (msg/s)`
   - **Panel type**: `Time series` (æ—¶é—´åºåˆ—)

4. ç‚¹å‡» **Apply**

#### æ­¥éª¤ 4: æ·»åŠ è¡Œæƒ…æ•°æ®é¢æ¿

1. å†æ¬¡æ·»åŠ æ–°é¢æ¿

2. Query:
   ```promql
   rate(market_data_tick_count[1m])
   ```

3. Panel options:
   - **Title**: `è¡Œæƒ…æ•°æ®é€Ÿç‡ (æŒ‰äº¤æ˜“å¯¹)`
   - **Panel type**: `Time series`
   - **Legend**: `{{symbol}}` (æ˜¾ç¤ºäº¤æ˜“å¯¹)

4. ç‚¹å‡» **Apply**

#### æ­¥éª¤ 5: ä¿å­˜ä»ªè¡¨æ¿

1. ç‚¹å‡»å³ä¸Šè§’ **ğŸ’¾ Save**

2. è¾“å…¥åç§°ï¼š`OKX å®æ—¶è¡Œæƒ…`

3. ç‚¹å‡» **Save**

---

## ğŸ¯ å¸¸ç”¨ PromQL æŸ¥è¯¢

### åŸºç¡€æŒ‡æ ‡

#### 1. WebSocket è¿æ¥çŠ¶æ€
```promql
websocket_connected
```

#### 2. æ€»æ¥æ”¶æ¶ˆæ¯æ•°
```promql
websocket_messages_received_total
```

#### 3. æ¶ˆæ¯æ¥æ”¶é€Ÿç‡
```promql
rate(websocket_messages_received_total[1m])
```

#### 4. è¡Œæƒ…æ•°æ®è®¡æ•°ï¼ˆæŒ‰äº¤æ˜“å¯¹ï¼‰
```promql
market_data_tick_count
```

#### 5. æŒ‡å®šäº¤æ˜“å¯¹æ•°æ®é€Ÿç‡
```promql
rate(market_data_tick_count{symbol="BTC-USDT"}[1m])
```

---

### é«˜çº§æŸ¥è¯¢

#### 1. å¹³å‡æ¯ç§’æ¥æ”¶æ¶ˆæ¯æ•°ï¼ˆ5åˆ†é’Ÿçª—å£ï¼‰
```promql
rate(websocket_messages_received_total[5m])
```

#### 2. æ‰€æœ‰äº¤æ˜“å¯¹æ•°æ®æ€»å’Œ
```promql
sum(market_data_tick_count)
```

#### 3. æŒ‰äº¤æ˜“å¯¹æ’åº (Top 10)
```promql
topk(10, market_data_tick_count)
```

#### 4. WebSocket è¿æ¥æ—¶é•¿
```promql
time() - websocket_connected_timestamp
```

---

## ğŸ”§ é¢æ¿é…ç½®æŠ€å·§

### æ—¶é—´èŒƒå›´è®¾ç½®

- **å³ä¸Šè§’æ—¶é—´é€‰æ‹©å™¨**:
  - `Last 5 minutes` - æœ€è¿‘ 5 åˆ†é’Ÿ
  - `Last 15 minutes` - æœ€è¿‘ 15 åˆ†é’Ÿ
  - `Last 1 hour` - æœ€è¿‘ 1 å°æ—¶

### è‡ªåŠ¨åˆ·æ–°

- **å³ä¸Šè§’åˆ·æ–°æŒ‰é’®** â†’ é€‰æ‹©åˆ·æ–°é¢‘ç‡:
  - `5s` - æ¯ 5 ç§’åˆ·æ–°
  - `10s` - æ¯ 10 ç§’åˆ·æ–°
  - `30s` - æ¯ 30 ç§’åˆ·æ–°

### é¢æ¿ç±»å‹é€‰æ‹©

- **Stat** (çŠ¶æ€å€¼): æ˜¾ç¤ºå•ä¸ªæ•°å€¼ï¼ˆå¦‚è¿æ¥çŠ¶æ€ï¼‰
- **Gauge** (ä»ªè¡¨ç›˜): æ˜¾ç¤ºç™¾åˆ†æ¯”æˆ–èŒƒå›´å€¼
- **Time series** (æ—¶é—´åºåˆ—): æ˜¾ç¤ºéšæ—¶é—´å˜åŒ–çš„æ›²çº¿
- **Bar chart** (æŸ±çŠ¶å›¾): å¯¹æ¯”å¤šä¸ªå€¼
- **Table** (è¡¨æ ¼): æ˜¾ç¤ºè¯¦ç»†æ•°æ®

---

## ğŸ“Š æ¨èä»ªè¡¨æ¿å¸ƒå±€

### å¸ƒå±€ 1: ç›‘æ§è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WebSocket çŠ¶æ€  â”‚  æ¶ˆæ¯é€Ÿç‡       â”‚
â”‚    (Stat)       â”‚  (Graph)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    è¡Œæƒ…æ•°æ®é€Ÿç‡ (æŒ‰äº¤æ˜“å¯¹)         â”‚
â”‚         (Time Series)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¸ƒå±€ 2: è¯¦ç»†è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿æ¥    â”‚ æ¶ˆæ¯    â”‚ Tick    â”‚
â”‚ çŠ¶æ€    â”‚ æ€»æ•°    â”‚ æ€»æ•°    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¶ˆæ¯æ¥æ”¶é€Ÿç‡ (1åˆ†é’Ÿå¹³å‡)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     å„äº¤æ˜“å¯¹æ•°æ®åˆ†å¸ƒ         â”‚
â”‚        (Bar Chart)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â“ å¸¸è§é—®é¢˜

### Q: çœ‹ä¸åˆ°ä»»ä½•æ•°æ®ï¼Ÿ

**æ£€æŸ¥æ¸…å•**:
1. âœ… OKX æœåŠ¡æ˜¯å¦è¿è¡Œ:
   ```powershell
   docker ps --filter "name=okx"
   ```

2. âœ… Prometheus æ˜¯å¦å¯è®¿é—®:
   ```
   http://localhost:8082/metrics
   ```

3. âœ… æ•°æ®æºæ˜¯å¦é…ç½®:
   - Grafana â†’ Configuration â†’ Data Sources
   - åº”è¯¥æœ‰ **Prometheus** (http://prometheus:9090)

### Q: æ•°æ®å»¶è¿Ÿå¾ˆé«˜ï¼Ÿ

**å¯èƒ½åŸå› **:
- åˆ·æ–°é—´éš”è®¾ç½®å¤ªé•¿ â†’ è°ƒæ•´ä¸º 5-10 ç§’
- æ—¶é—´èŒƒå›´å¤ªå¤§ â†’ ç¼©å°åˆ° 5-15 åˆ†é’Ÿ

### Q: æƒ³çœ‹åŸå§‹æ•°æ®ï¼Ÿ

**æ–¹æ³•**:
1. åœ¨ Explore ä¸­è¿è¡ŒæŸ¥è¯¢
2. åˆ‡æ¢åˆ° **Table** è§†å›¾
3. å¯ä»¥çœ‹åˆ°æ‰€æœ‰æŒ‡æ ‡å’Œæ ‡ç­¾

---

## ğŸ¨ æ¨èé…è‰²æ–¹æ¡ˆ

### è¿æ¥çŠ¶æ€
- **ç»¿è‰²** (Green): å·²è¿æ¥ (value = 1)
- **çº¢è‰²** (Red): æœªè¿æ¥ (value = 0)

### æ¶ˆæ¯é€Ÿç‡
- **è“è‰²** (Blue): æ­£å¸¸
- **æ©™è‰²** (Orange): è­¦å‘Šé˜ˆå€¼
- **çº¢è‰²** (Red): å¼‚å¸¸é˜ˆå€¼

---

## ğŸš€ ä¸‹ä¸€æ­¥

### 1. æ·»åŠ å‘Šè­¦è§„åˆ™

åœ¨ Grafana ä¸­é…ç½®å‘Šè­¦:
- WebSocket æ–­å¼€ â†’ å‘é€é€šçŸ¥
- æ¶ˆæ¯é€Ÿç‡å¼‚å¸¸ â†’ å‘é€é€šçŸ¥

### 2. å¯¼å‡º/å¯¼å…¥ä»ªè¡¨æ¿

- **å¯¼å‡º**: Dashboard â†’ Share â†’ Export â†’ Save to file
- **å¯¼å…¥**: Import â†’ Upload JSON file

### 3. é›†æˆå…¶ä»–æ•°æ®

- æ·»åŠ æ›´å¤š Prometheus æŒ‡æ ‡
- è¿æ¥ TimescaleDB æŸ¥çœ‹å†å²æ•°æ®

---

## ğŸ“š ç›¸å…³èµ„æº

- **Grafana å®˜æ–¹æ–‡æ¡£**: https://grafana.com/docs/
- **PromQL æŸ¥è¯¢è¯­æ³•**: https://prometheus.io/docs/prometheus/latest/querying/basics/
- **TTQuant ç³»ç»ŸæŒ‡æ ‡**: http://localhost:8082/metrics

---

**æœ€åæ›´æ–°**: 2026-02-10 20:10  
**æç¤º**: æŒ‰ `Ctrl + /` åœ¨ Grafana ä¸­æ‰“å¼€å¿«æ·é”®å¸®åŠ©  
**æ”¯æŒ**: å¦‚æœ‰é—®é¢˜å‚è€ƒ `SUCCESS_OKX.md`
